---

title: Metadatasets: a dataset of datasets


keywords: fastai
sidebar: home_sidebar

summary: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
description: "This functionality will allow you to create a dataset from data stores in multiple, smaller datasets."
nb_path: "nbs/002c_data.metadatasets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/002c_data.metadatasets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>I'd like to thank both Thomas Capelle (<a href="https://github.com/tcapelle">https://github.com/tcapelle</a>)  and Xander Dunn (<a href="https://github.com/xanderdunn">https://github.com/xanderdunn</a>) for their contributions to make this code possible. </li>
<li>This functionality allows you to use multiple numpy arrays instead of a single one, which may be very useful in many practical settings. I've tested it with 10k+ datasets and it works well. </li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDataset" class="doc_header"><code>class</code> <code>TSMetaDataset</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/metadatasets.py#L12" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDataset</code>(<strong><code>dataset_list</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>A dataset capable of indexing mutiple datasets at the same time</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TSMetaDatasets" class="doc_header"><code>class</code> <code>TSMetaDatasets</code><a href="https://github.com/timeseriesAI/tsai/tree/main/tsai/data/metadatasets.py#L62" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TSMetaDatasets</code>(<strong><code>metadataset</code></strong>, <strong><code>splits</code></strong>) :: <code>FilteredBase</code></p>
</blockquote>
<p>Base class for lists with subsets</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's create 3 datasets. In this case they will have different sizes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">L</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">])</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">vocab</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">,))]</span>
    <span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">TSClassification</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">TSDatasets</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="n">tfms</span><span class="p">)</span>
    <span class="n">dsets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
<span class="n">dsets</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(#50) [(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(5)),(TSTensor(vars:5, len:50), TensorCategory(5)),(TSTensor(vars:5, len:50), TensorCategory(4)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(3)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(4)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(1))...],
 (#111) [(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(5)),(TSTensor(vars:5, len:50), TensorCategory(8)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(3)),(TSTensor(vars:5, len:50), TensorCategory(10))...],
 (#110) [(TSTensor(vars:5, len:50), TensorCategory(6)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(10)),(TSTensor(vars:5, len:50), TensorCategory(1)),(TSTensor(vars:5, len:50), TensorCategory(6)),(TSTensor(vars:5, len:50), TensorCategory(6)),(TSTensor(vars:5, len:50), TensorCategory(7)),(TSTensor(vars:5, len:50), TensorCategory(9)),(TSTensor(vars:5, len:50), TensorCategory(2)),(TSTensor(vars:5, len:50), TensorCategory(10))...]]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadataset</span> <span class="o">=</span> <span class="n">TSMetaDataset</span><span class="p">(</span><span class="n">dsets</span><span class="p">)</span>
<span class="n">metadataset</span><span class="p">,</span> <span class="n">metadataset</span><span class="o">.</span><span class="n">vars</span><span class="p">,</span> <span class="n">metadataset</span><span class="o">.</span><span class="n">len</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;__main__.TSMetaDataset at 0x7fd719f0c950&gt;, 5, 50)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll apply splits now to create train and valid metadatasets:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">TimeSplitter</span><span class="p">()(</span><span class="n">metadataset</span><span class="p">)</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#217) [0,1,2,3,4,5,6,7,8,9...],
 (#54) [217,218,219,220,221,222,223,224,225,226...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">metadatasets</span> <span class="o">=</span> <span class="n">TSMetaDatasets</span><span class="p">(</span><span class="n">metadataset</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
<span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;__main__.TSMetaDataset at 0x7fd71a120a90&gt;,
 &lt;__main__.TSMetaDataset at 0x7fd71a120e90&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(TSTensor(samples:64, vars:5, len:50),
 TensorCategory([ 7,  4,  9,  2,  3,  2, 10,  6,  1, 10,  7,  3,  9,  9,  7,  3,  2,  2,
          5,  3,  5,  5,  3,  7,  7, 10,  4,  3,  3,  1, 10,  3,  9,  6,  4,  4,
          7,  2,  4,  8,  2,  9,  4,  5,  3,  7, 10,  9,  9, 10,  7,  9,  3, 10,
          7,  5,  6,  6, 10,  5,  8,  9,  8,  5]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There also en easy way to map any particular sample in a batch to the original dataset and id:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">metadatasets</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">metadatasets</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="p">)</span>
<span class="n">mappings</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">xbi</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)):</span>
    <span class="n">ds</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">mappings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">xbi</span><span class="p">)</span>
    <span class="n">test_close</span><span class="p">(</span><span class="n">dsets</span><span class="p">[</span><span class="n">ds</span><span class="p">][</span><span class="n">idx</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">ybi</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For example the 3rd sample in this batch would be:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">mapping_idxs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 0, 38], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

